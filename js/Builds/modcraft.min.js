var ModCraft=function(a){Object.defineProperty(this,"register",{configurable:!1,enumerable:!0,value:a.register}),Object.defineProperty(this,"resolve",{configurable:!1,enumerable:!0,value:a.resolve})};!function(){function a(){function e(a,b,c){if(a in c)return c[a];for(var d=b.filter(function(b){return b.names.indexOf(a)>=0}),e=[],g=0;g<d.length;g++){var h=d[g];if("instance"in h)e.push(h.instance);else{var i=f(h.dependencies,h.constructor,b,c);e.push(i),(h.singleton||h.contextual)&&(h.instance=i)}}return e.length>1?e:e[0]}function f(a,b,c,d){function f(){b.apply(this,g)}var g=a.map(function(a){return e(a,c,d)});return f.prototype=b.prototype,new f}var g=this,h=[];Object.defineProperty(g,"register",{configurable:!1,enumerable:!0,value:{}}),Object.defineProperty(g.register,"instance",{configurable:!1,enumerable:!0,value:function(a,c){var d=new b(a,[],function(){});d.singleton=!0,d.instance=c,h.push(d)}}),Object.defineProperty(g.register,"singleton",{configurable:!1,enumerable:!0,value:function(a,c,d){var e=new b(a,c,d);e.singleton=!0,h.push(e)}}),Object.defineProperty(g.register,"contextual",{configurable:!1,enumerable:!0,value:function(a,c,d){var e=new b(a,c,d);e.contextual=!0,h.push(e)}}),Object.defineProperty(g.register,"transient",{configurable:!1,enumerable:!0,value:function(a,c,d){var e=new b(a,c,d);h.push(e)}}),Object.defineProperty(g,"branch",{configurable:!1,enumerable:!0,value:function(){for(var b=new a,c=0;c<h.length;c++){var d=h[c];"instance"in d&&d.singleton?b.register.instance(d.names,d.instance):d.singleton?b.register.singleton(d.names,d.dependencies,d.constructor):d.contextual?b.register.contextual(d.names,d.dependencies,d.constructor):b.register["transient"](d.names,d.dependencies,d.constructor)}return b}}),Object.defineProperty(g,"resolve",{configurable:!1,enumerable:!0,value:function(a,b){var g=h.map(function(a){return a.singleton?a:c(a)});if("string"==typeof a)return e(a,g,b||{});var i=arguments[0]instanceof Array?arguments[0]:[],j=d(arguments).filter(function(a){return"function"==typeof a})[0],b=arguments[arguments.length-1];if(b=b instanceof Array||"object"!=typeof b?{}:b,j="function"==typeof j?j:i.filter(function(a){return"function"==typeof a})[0],!j)throw"Can't Resolve";var i=i.filter(function(a){return"string"==typeof a});return f(i,j,g,b)}}),Object.defineProperty(g.resolve,"all",{configurable:!1,enumerable:!0,value:function(a){var b=g.resolve(a);return b instanceof Array?b:[b]}})}function b(a,b,c){if(this.names=d(a).filter(function(a){return"string"==typeof a}),!this.names.length)throw"Invalid Name(s)";if(this.constructor="function"==typeof c?c:"function"==typeof b?b:b instanceof Array?b.filter(function(a){return"function"==typeof a})[0]:!1,!this.constructor)throw"Invalid Constructor";this.dependencies=d(b).filter(function(a){return"string"==typeof a}),this.singleton=!1,this.contextual=!1}function c(a){var b={};for(var c in a)b[c]=a[c];return b}function d(a){if(a instanceof Array)return a;if("string"==typeof a)return[a];try{return Array.prototype.slice.call(a,0)}catch(b){return"undefined"==typeof a?[]:[a]}}Object.defineProperty(ModCraft,"DependencyResolver",{configurable:!1,enumerable:!0,value:a})}(),function(){function a(a,b){return a=a instanceof Array?a:"string"==typeof a?[a]:[],b=b instanceof Array?b:"string"==typeof b?[b]:[],a.concat(b)}var b=new ModCraft.DependencyResolver;Object.defineProperty(ModCraft,"register",{configurable:!1,enumerable:!0,value:{}}),Object.defineProperty(ModCraft.register,"service",{configurable:!1,enumerable:!0,value:function(c,d,e){b.register.singleton(a(c,"services"),d,e)}}),Object.defineProperty(ModCraft.register,"module",{configurable:!1,enumerable:!0,value:function(c,d,e){b.register.singleton(a(c,"modules"),d,e)}}),Object.defineProperty(ModCraft.register,"dependency",{configurable:!1,enumerable:!0,value:b.register.contextual}),Object.defineProperty(ModCraft.register.dependency,"instance",{configurable:!1,enumerable:!0,value:b.register.instance}),Object.defineProperty(ModCraft.register.dependency,"singleton",{configurable:!1,enumerable:!0,value:b.register.singleton}),Object.defineProperty(ModCraft.register.dependency,"contextual",{configurable:!1,enumerable:!0,value:b.register.contextual}),Object.defineProperty(ModCraft.register.dependency,"transient",{configurable:!1,enumerable:!0,value:b.register["transient"]}),Object.defineProperty(ModCraft,"resolve",{configurable:!1,enumerable:!0,value:b.resolve}),Object.defineProperty(ModCraft,"start",{configurable:!1,enumerable:!0,value:function(){function a(a,b){for(var c=0;c<e.length;c++){var d=e[c];if(a in d){var f=d.name||"a module";console.log(b+" "+f),d[a]()}}}console.log("Starting Application");var c=b.branch();c.register.instance("dependencies",c);var d=c.resolve(["dependencies",ModCraft]);c.register.instance("application",d),console.log("Loading Modules");var e=c.resolve.all("modules");return a("init","Initializing"),a("start","Starting"),console.log("Application Ready"),d}})}();